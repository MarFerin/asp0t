<!DOCTYPE HTML>
<html>
	<head>
		<title>Agarspot</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<link rel="stylesheet" href="assets/css/main.css" />
		<link rel="shortcut icon" type="image/x-icon" href="favicon.ico" />
		<link rel="icon" type="image/x-icon" href="favicon.ico" />
		<!--[if lte IE 9]><link rel="stylesheet" href="assets/css/ie9.css" /><![endif]-->
		<noscript><link rel="stylesheet" href="assets/css/noscript.css" /></noscript>
		<script src="assets/js/jquery.min.js"></script>
			<script src="assets/js/skel.min.js"></script>
			<script src="assets/js/util.js"></script>
			<script src="assets/js/main.js"></script>
			<script>
				function create(){
					if(validation()){
						$('#loading').show();
						$('#create').prop('disabled', true);
						var sendJson = {"Key":$('#key').val(), "ServerName":$('#server-name').val(), "Slots":$('#slots').val(),"Domain":$('#domain-name').val(), "Subdomain":$('#server-subdomain').val(), "TeamspeakStyle":$('#teamspeak-style').val(), 
								"ClientPerms":$('#client-permissions').is(':checked'), "ChannelClientPerms":$('#channel-client-permissions').is(':checked'), 
								"ServerLogging":$('#server-logging').is(':checked')};
						$.ajax({
							type: "POST",
							url: "/ajax.php",
							dataType: "json",
							data: {createGuestTeamspeak:sendJson},
							success: function(data) {
								if(data["Error"]==0){
									var dataRead = data["Response"];
									$("#Connection").attr("href", 'ts3server://'+dataRead["URL"]+'?token='+dataRead["token"]);
									$("#Connection").show();
									$('#loading').hide();
								}
								else{
									var errorMessage = data["Response"];
									$('#loading').hide();
									if(data["Error"]==10){
										$('#keyError').html(errorMessage);
									}
								}
							}
						});
					}
				}
				function validation(){
					var returnvalue = true;
					if($('#server-name').val()==""){
						document.getElementById("server-name").setCustomValidity("Invalid Name.");
						document.getElementById("nameError").innerHTML = "*Name cannot be empty.";
						returnvalue = false;
					}
					else if($('#server-name').val().length>30){
						document.getElementById("server-name").setCustomValidity("Invalid Name.");
						document.getElementById("nameError").innerHTML = "*Name is too long.";
						returnvalue = false;
					}
					if($('#server-subdomain').val()==""){
						document.getElementById("server-subdomain").setCustomValidity("Invalid Subdomain.");
						document.getElementById("domainError").innerHTML = "*Subdomain cannot be empty.";
						returnvalue = false;
					}
					else if($('#server-name').val().length>30){
						document.getElementById("server-subdomain").setCustomValidity("Invalid Subdomain.");
						document.getElementById("domainError").innerHTML = "*Subdomain too long.";
						returnvalue = false;
					}
					return returnvalue;
				}
				function clearValidity(){
					document.getElementById("server-subdomain").setCustomValidity("");
					document.getElementById("domainError").innerHTML = "";
				}
				function checkTSDNS(){
					if($('#server-subdomain').val()==""){
						document.getElementById("server-subdomain").setCustomValidity("Invalid Subdomain.");
						document.getElementById("domainError").innerHTML = "*Subdomain cannot be empty.";
						return 1;
					}
					var sendJson = {"Subdomain":$('#server-subdomain').val(),"Domain":$('#domain-name').val()};
					$.ajax({
						type: "POST",
						url: "/ajax.php",
						dataType: "json",
						data: {checkTSDNS:sendJson},
						success: function(data) {
							if(data["Error"]==0){
								document.getElementById("server-subdomain").setCustomValidity("");
								document.getElementById("domainError").innerHTML = "";
							}
							if(data["Error"]==2){
								document.getElementById("server-subdomain").setCustomValidity("Invalid Subdomain.");
								document.getElementById("domainError").innerHTML = "*Invalid Subdomain";
							}
							else if(data["Error"]==3){
								document.getElementById("server-subdomain").setCustomValidity("Subdomain Taken.");
								document.getElementById("domainError").innerHTML = "*Subdomain Taken.";
							}
							return data["Error"];
						}
					});
				}
				function isNumberKey(evt){
					var charCode = (evt.which) ? evt.which : event.keyCode
					if (charCode > 31 && (charCode < 48 || charCode > 57)){
						evt.target.setCustomValidity("Invalid field.");
						setTimeout(setValid, 400);
						return false;
					}
					setValid();
					return true;
				}
				function checkOverflow(evt){
					if(parseInt(evt.target.value)>500){
						evt.target.value = 500;
						evt.target.setCustomValidity("Invalid field.");
						setTimeout(setValid, 400);
					}
				}
				function setValid(){
					document.getElementById("slots").setCustomValidity("");
				}
			</script>
	</head>
	<body>

		<!-- Wrapper -->
			<div id="wrapper">
				<nav style="top: 10px;right: 10px;position: absolute;">
					<ul>
						<li><a style="text-align: center;" href="/teamspeak/">Login</a></li>
					</ul>
				</nav>
				<!-- Header -->
					<header id="header">
						<div class="logo">
							<span class="icon fa-server"></span>
						</div>
						<div class="content">
							<div class="inner">
								<h1>Agarspot</h1>
								<p>A fully free teamspeak hosting solution.<br>
								Talk to us at <a href="ts3server://ts.agarspot.com">ts.agarspot.com</a>!</p>
							</div>
						</div>
						<nav>
							<ul>
								<li><a href="#features">Features</a></li>
								<li><a href="#teamspeak">Create Teamspeak</a></li>
								<li><a href="#contact">Contact</a></li>
							</ul>
						</nav>
					</header>

				<!-- Main -->
					<div id="main">

						<!-- Features -->
							<article id="features">
								<h2 class="major">Features</h2>
								<span class="image main"><img src="images/pic01.jpg" alt="" /></span>
								<ul>
									<li>Teamspeaks are absolutely free.</li>
									<li>Customer support guaranteed.</li>
									<li>If you aren't satisfied then your money back!</li>
								</ul>
							</article>

						<!-- Account -->
							<article id="account">
								<h2 class="major">My Account</h2>
								<form method="post" action="#">
									<div class="field half first" style="margin-bottom:0px">
										<label for="username">Username</label>
										<input type="text" name="username" id="username" value="" placeholder="Enter Username"/>
										<p id="usernameError" class="errormessage"></p>
									</div>
									<div class="field half" style="margin-bottom:0px">
										<label for="password">Password</label>
										<input type="password" name="password" id="password" placeholder="Enter Password"/>
										<p id="passwordError" class="errormessage"></p>
									</div>
								</form>
								<button id="login" class="special" style="margin-right:12px">Login</button>
								<button id="createAccount" onclick="create()">Create Account</button>
							</article>

						<!-- Pricing -->
							<article id="pricing">
								<h2 class="major">Pricing</h2>
								<section>
									<h4>Teamspeak</h4>
									<div class="table-wrapper">
										<table class="alt">
											<thead>
												<tr>
													<th>Slots</th>
													<th>Description</th>
													<th>Price</th>
												</tr>
											</thead>
											<tbody>
												<tr>
													<td>32 Slots</td>
													<td>Perfect for a small squad.</td>
													<td>$0</td>
												</tr>
												<tr>
													<td>64 Slots</td>
													<td>Accommodates a small clan.</td>
													<td>$0</td>
												</tr>
												<tr>
													<td>128 Slots</td>
													<td>Easily supports medium sized clans.</td>
													<td>$0</td>
												</tr>
												<tr>
													<td>256 Slots</td>
													<td>Fit for large clans.</td>
													<td>$0</td>
												</tr>
												<tr>
													<td>512 Slots</td>
													<td>Perfect for tournaments or other events.</td>
													<td>$0</td>
												</tr>
											</tbody>
										</table>
									</div>
								</section>
							</article>

						<!-- Contact -->
							<article id="contact">
								<h2 class="major">Contact</h2>
								<p>Contact staff at <a href="ts3server://ts.agarspot.com">ts.agarspot.com</a> for a teamspeak or for support.</p>
							</article>
						<!--Create Teamspeak -->
							<article id="teamspeak">
								<h2 class="major">Teamspeak</h2>

								<section>
									<h3>Create your own teamspeak</h3>
									<form style="margin-bottom: 0.2rem">
										<div class="field half first" style="margin-bottom:0px">
											<label for="server-name">Server Name</label>
											<input type="text" name="server-name" id="server-name" value="" placeholder="My Teamspeak Name" />
											<p id="nameError" class="errormessage"></p>
										</div>
										<div class="field half" style="margin-bottom:0px">
											<label for="slots">Slots</label>
											<input type="text" name="slots" id="slots" placeholder="Max 500" value="200" onkeyup="checkOverflow(event)" onkeypress="return isNumberKey(event)"/>
											<p id="slotsError" class="errormessage"></p>
										</div>
										<label>Subdomian</label>
										<div style="margin-bottom:0px">
											<input type="text" name="server-subdomain" id="server-subdomain" value="" placeholder="example" onkeyup="clearValidity()" onblur="checkTSDNS()" style="display: inline; text-align: right;
													width: 20%; padding-right:5px;"/>
											<div class="sselect-wrapper" style="width:40%;display:inline">
												<select name="domain-name" id="domain-name" style="width:40%;display:inline;padding:5px">
													<option value="1">.agarspot.com</option>
													<option value="3">.ogarhub.io</option>
												</select>
											</div>
											<p id="domainError" class="errormessage"></p>
										</div>
										<label>Select your teamspeak style</label>
										<div class="select-wrapper">
											<select name="teamspeak-style" id="teamspeak-style">
												<option value="1">Clan</option>
												<option value="3">Blank Teamspeak</option>
											</select>
										</div>
										<br>
										<label>Advanced Permissions</label>
										<input type="checkbox" id="client-permissions" name="client-permissions">
										<label for="client-permissions">Enable Client Permissions</label>
										<input type="checkbox" id="channel-client-permissions" name="channel-client-permissions">
										<label for="channel-client-permissions">Enable Channel-Client Permissions</label>
										<label for="key" style="margin-top: 0.7rem;text-transform: none;;">KEY</label>
										<input type="text" placeholder="Ask staff at ts.agarspot.com for a key" name="key" id="key"/>
										<p id="keyError" class="errormessage"></p>
									</form>
									<button id="create" onclick="create()" style="margin-right:1rem">Create Server</button>
									<div id="loading" class="bubbles-wrapper" style="display: none">
										<div class="bubbles" id="b1"></div>
										<div class="bubbles" id="b2"></div>
										<div class="bubbles" id="b3"></div>
										<div class="bubbles" id="b4"></div>
										<div class="bubbles" id="b5"></div>
									</div>
									<a class="button" id="Connection" style="display: none;margin-right:1rem">Connect</a>
								</section>
							</article>
					</div>

				<!-- Footer -->
					<footer id="footer">
						<p class="copyright">&copy; Agarspot.</p>
					</footer>

			</div>

		<!-- BG -->
			<div id="bg" class="firstPage"></div>

		<!-- Scripts -->
			

	</body>
</html>
